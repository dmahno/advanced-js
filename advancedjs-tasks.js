'use strict';

///////////////////////////////////////////////////////////////////////////
/////////////////////////////////Ğ—ĞĞ”ĞĞĞ˜Ğ• 1/////////////////////////////////
///////////////////////////////////////////////////////////////////////////

// ĞĞ°Ğ¿Ğ¸ÑĞ°Ñ‚ÑŒ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ, ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ°Ñ Ğ¿Ñ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚ Ğ¾Ğ±ÑŠĞµĞºÑ‚
// Ğ¸ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Ğ²ÑĞµ ÑĞ²Ğ¾Ğ¹ÑÑ‚Ğ²Ğ° Ğ¸ ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ñ‹ ĞºĞ°Ğº Ğ² ÑĞ°Ğ¼Ğ¾Ğ¼ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğµ,
// Ñ‚Ğ°Ğº Ğ¸ Ğ²Ğ¾ Ğ²ÑĞµĞ¹ ĞµĞ³Ğ¾ Ñ†ĞµĞ¿Ğ¾Ñ‡ĞºĞµ Ğ¿Ñ€Ğ¾Ñ‚Ğ¾Ñ‚Ğ¸Ğ¿Ğ¾Ğ².

// ------------- Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ Ñ‡ĞµÑ€ĞµĞ· Ñ†Ğ¸ĞºĞ» do while

function allKeysAndSymbols(object) {
  const properties = [];
  do {
    Object.getOwnPropertyNames(object).forEach((property) => {
      if (properties.indexOf(property)) {
        properties.push(property);
      }
    });
  } while ((object = Object.getPrototypeOf(object)));
  return properties;
}
allKeysAndSymbols({}); // ["constructor", "__defineGetter__", "__defineSetter__", "hasOwnProperty", ... ]
console.log(allKeysAndSymbols({ a: '2' }));

// -------------- Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ Ğ±ĞµĞ· Ñ†Ğ¸ĞºĞ»Ğ° do while (Ñ Ñ€Ğ°Ğ·Ğ±Ğ¾Ñ€Ğ¾Ğ¼) Ğ»ÑƒÑ‡ÑˆĞµ Ñ‡Ğ¸Ñ‚Ğ°ĞµÑ‚ÑÑ (Ñ‡ĞµĞ¼ Ğ¿Ñ€Ğ¾Ñ‰Ğµ, Ñ‚ĞµĞ¼ Ğ»ÑƒÑ‡ÑˆĞµ Ñ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ Ğ¸ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°Ñ‚ÑŒ)

function allKeysAndSymbols(object) {
  const properties = [];
  // ÑĞ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ğ¿Ñ€Ğ¾Ñ‚Ğ¾Ñ‚Ğ¸Ğ¿ Ğ¾Ñ‚ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ° object (Ñ‡ĞµÑ€ĞµĞ· Ğ¼ĞµÑ‚Ğ¾Ğ´ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ° getPrototypeOf)
  object = Object.getPrototypeOf(object);
  // Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµĞ¼ Ğ¼Ğ°ÑÑĞ¸Ğ² Ğ¸Ğ· ÑĞ²Ğ¾Ğ¹ÑÑ‚Ğ² Ğ¿Ñ€Ğ¾Ñ‚Ğ¾Ñ‚Ğ¸Ğ¿Ğ° Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ° object Ğ¸ Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ ÑĞ²Ğ¾Ğ¹ÑÑ‚Ğ²Ğ° property Ğ²ÑÑ‚Ğ°Ğ²Ğ»ÑĞµĞ¼ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ½Ñ‹Ğµ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ñ‹ Ğ² Ğ¼Ğ°ÑÑĞ¸Ğ² properties,
  Object.getOwnPropertyNames(object).forEach((property) => {
    // Ğ²ÑÑ‚Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ½Ñ‹Ğµ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ñ‹ Ğ² Ğ¼Ğ°ÑÑĞ¸Ğ² properties,
    properties.push(property);
  });
  return properties;
}

allKeysAndSymbols({}); // ["constructor", "__defineGetter__", "__defineSetter__", "hasOwnProperty", ... ]
console.log(allKeysAndSymbols({ a: '2' }));

///////////////////////////////////////////////////////////////////////////
/////////////////////////////////Ğ—ĞĞ”ĞĞĞ˜Ğ• 2/////////////////////////////////
///////////////////////////////////////////////////////////////////////////

// // in, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹ Ğ¸Ğ³Ğ½Ğ¾Ñ€Ğ¸Ñ€ÑƒĞµÑ‚ ÑĞ²Ğ¾Ğ¹ÑÑ‚Ğ²Ğ° Ğ¿Ñ€Ğ¾Ñ‚Ğ¾Ñ‚Ğ¸Ğ¿Ğ°
// // ĞĞ°Ğ¿Ğ¸ÑĞ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾ĞºÑĞ¸-Ğ¾Ğ±ÑŠĞµĞºÑ‚, Ğ´Ğ»Ñ ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ¾Ğ³Ğ¾ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€
// // in Ğ²ĞµÑ€Ğ½ĞµÑ‚ Ğ¸ÑÑ‚Ğ¸Ğ½Ñƒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ² Ñ‚Ğ¾Ğ¼ ÑĞ»ÑƒÑ‡Ğ°ĞµÑ‚,
// // ĞºĞ¾Ğ³Ğ´Ğ° ÑĞ²Ğ¾Ğ¹ÑÑ‚Ğ²Ğ¾ Ğ½Ğ°Ñ…Ğ¾Ğ´Ğ¸Ñ‚ÑÑ Ğ² ÑĞ°Ğ¼Ğ¾Ğ¼ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğµ, Ğ½Ğ¾ Ğ½Ğµ Ğ² ĞµĞ³Ğ¾ Ğ¿Ñ€Ğ¾Ñ‚Ğ¾Ñ‚Ğ¸Ğ¿Ğµ.

const proto = { value: 42 };
// ÑĞ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ Ğ¾Ğ±ÑŠĞµĞºÑ‚ Ñ ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ½Ñ‹Ğ¼ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ¾Ğ¼ Ğ¿Ñ€Ğ¾Ñ‚Ğ¾Ñ‚Ğ¸Ğ¿Ğ° Ğ¸ ĞµĞ³Ğ¾ ÑĞ²Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°Ğ¼Ğ¸
const object = Object.create(proto);

// Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµĞ¼ ÑĞ²Ğ¾Ğ¹ÑÑ‚Ğ²Ğ¾ year ÑĞ¾ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸ĞµĞ¼ 2020 Ğ´Ğ»Ñ Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ° Ğ¿Ñ€Ğ¾Ñ‚Ğ¾Ñ‚Ğ¸Ğ¿Ğ°
Object.defineProperty(object, 'year', {
  value: 2020,
  // Ğ¿Ğ¾Ğ·Ğ²Ğ¾Ğ»ÑĞµĞ¼ Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°Ñ‚ÑŒ Ğ´Ğ°Ğ½Ğ½Ğ¾Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ
  writable: true,
  // Ğ¿Ğ¾Ğ·Ğ²Ğ¾Ğ»ÑĞµĞ¼ ÑƒĞ´Ğ°Ğ»ÑÑ‚ÑŒ/Ğ¸Ğ·Ğ¼ĞµĞ½ÑÑ‚ÑŒ Ğ´Ğ°Ğ½Ğ½Ğ¾Ğµ ÑĞ²-Ğ²Ğ¾
  configurable: true,
  // ÑĞ²Ğ¾Ğ¹ÑÑ‚Ğ²Ğ¾ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ Ğ¿Ñ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµĞ½Ğ¾/Ğ¿ĞµÑ€ĞµÑ‡Ğ¸ÑĞ»ĞµĞ½Ğ½Ğ¾ Ğ² Ñ†Ğ¸ĞºĞ»Ğ°Ñ…
  enumerable: false,
});

// Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‘Ğ¼ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ ÑĞ¸Ğ¼Ğ²Ğ¾Ğ» Ñ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸ĞµĞ¼ (Ğ¸Ğ¼ĞµĞ½ĞµĞ¼ bazzinga)
const symbol = Symbol('bazzinga');
// Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ½Ğ¾Ğ¼Ñƒ ÑĞ¸Ğ²Ğ¾Ğ»Ñƒ Ğ¿Ñ€Ğ¸ÑĞ²Ğ°ĞµĞ²Ğ°ĞµĞ¼ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ 42 Ğ¸ Ğ²ÑÑ‚Ğ°Ğ²Ğ»ÑĞµĞ¼ Ğ² Ğ½Ğ°Ñˆ Ğ¾Ğ±ÑŠĞµĞºÑ‚
object[symbol] = 42;

// Ğ±ĞµĞ· proxy
console.log('value' in object); // true
console.log('year' in object); // true
console.log(symbol in object); // true

// Ğ¾Ğ±ÑŠÑĞ²Ğ»ÑĞµĞ¼ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ‚Ğ¾Ñ€ ĞŸÑ€Ğ¾ĞºÑĞ¸
const handler = {
  // Ğ’Ğ½Ğ¸Ğ·Ñƒ Ğ² clg Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€ in, Ğ´Ğ»Ñ Ñ‚Ğ¾Ğ³Ğ¾, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ, Ñ‡Ñ‚Ğ¾ Ğ½ĞµĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ Ğ½Ğ°Ñ…Ğ¾Ğ´Ğ¸Ñ‚ÑÑ Ğ² ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ½Ğ¾Ğ¼ Ğ¼ĞµÑÑ‚Ğµ (Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğµ).
  // Ğ›Ğ¾Ğ²ÑƒÑˆĞºĞ° has Ğ¿ĞµÑ€ĞµÑ…Ğ²Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ²Ñ‹Ğ·Ğ¾Ğ²Ñ‹ in
  // target - ÑÑ‚Ğ¾ Ğ¾Ñ€Ğ¸Ğ³Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¾Ğ±ÑŠĞµĞºÑ‚, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹ Ğ¿ĞµÑ€ĞµĞ´Ğ°Ğ²Ğ°Ğ»ÑÑ Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¼ Ğ°Ñ€Ğ³ÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ¼ Ğ² ĞºĞ¾Ğ½ÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€ new Proxy
  // property - Ğ¸Ğ¼Ñ ÑĞ²Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°
  has(target, property) {
    // Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµĞ¼ ÑĞ²Ğ¾Ğ¹ÑÑ‚Ğ²Ğ¾ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ° target
    return target.hasOwnProperty(property);
  },
};
// ĞĞ±ÑŠĞµĞºÑ‚ Proxy Â«Ğ¾Ğ±Ğ¾Ñ€Ğ°Ñ‡Ğ¸Ğ²Ğ°ĞµÑ‚ÑÑÂ» Ğ²Ğ¾ĞºÑ€ÑƒĞ³ Ğ´Ñ€ÑƒĞ³Ğ¾Ğ³Ğ¾ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ° Ğ¸ Ğ¿ĞµÑ€ĞµÑ…Ğ²Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ Ñ€Ğ°Ğ·Ğ½Ñ‹Ğµ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ Ñ Ğ½Ğ¸Ğ¼, Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€ Ñ‡Ñ‚ĞµĞ½Ğ¸Ğµ/Ğ·Ğ°Ğ¿Ğ¸ÑÑŒ ÑĞ²Ğ¾Ğ¹ÑÑ‚Ğ².
// Ğ¿ĞµÑ€ĞµĞ´Ğ°ĞµĞ¼ Ğ¾Ğ±ÑŠĞµĞºÑ‚ Ğ¸ Ğ¿ĞµÑ€ĞµĞ´Ğ°ĞµĞ¼ Ğ»Ğ¾Ğ²ÑƒÑˆĞºÑƒ handler
const proxy = new Proxy(object, handler);

// Ñ proxy
console.log('value' in proxy); // false
console.log('year' in proxy); // true
console.log(symbol in proxy); // true

///////////////////////////////////////////////////////////////////////////
/////////////////////////////////Ğ—ĞĞ”ĞĞĞ˜Ğ• 3/////////////////////////////////
///////////////////////////////////////////////////////////////////////////

// asyncExecutor
// ĞĞ°Ğ¿Ğ¸ÑĞ°Ñ‚ÑŒ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ,
// ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ°Ñ Ğ¿Ğ¾Ğ·Ğ²Ğ¾Ğ»Ğ¸Ñ‚ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ²Ğ½ÑƒÑ‚Ñ€Ğ¸ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€Ğ° Ğ°ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ½Ñ‹Ğµ Ğ²Ñ‹Ğ·Ğ¾Ğ²Ñ‹.
// Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ½Ğ° Promise, async/await Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€ĞµÑ‰ĞµĞ½Ğ¾.

function asyncExecutor(generator) {
  // Ğ²Ñ‹Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½ÑƒÑ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ execute, ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ°Ñ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€,
  // Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¼Ğ¸ Ğ²Ñ‹Ğ·Ğ¾Ğ²Ğ°Ğ¼Ğ¸ next Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ Ğ¸Ğ· Ğ½ĞµĞ³Ğ¾ Ğ¿Ñ€Ğ¾Ğ¼Ğ¸ÑÑ‹ â€“ Ğ¾Ğ´Ğ¸Ğ½ Ğ·Ğ° Ğ´Ñ€ÑƒĞ³Ğ¸Ğ¼
  // Ğ¸, ĞºĞ¾Ğ³Ğ´Ğ° Ğ¾Ñ‡ĞµÑ€ĞµĞ´Ğ½Ğ¾Ğ¹ Ğ¿Ñ€Ğ¾Ğ¼Ğ¸Ñ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑÑ, Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ ĞµĞ³Ğ¾ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ Ğ² Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¼ next
  execute(generator());
  // Ğ¿ĞµÑ€ĞµĞ´Ğ°ĞµĞ¼ 2 Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ° Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ execute genData, callData
  const execute = (genData, callData) => {
    // Ğ´ĞµĞ»Ğ°ĞµĞ¼ Ğ´ĞµÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿ĞµÑ€ĞµĞ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ²Ğ² callData Ğ¿Ğ¾ ÑÑ€ĞµĞ´ÑÑ‚Ğ²Ğ°Ğ¼ next
    const { value, finished } = genData.next(callData);
    // ĞµÑĞ»Ğ¸ finished true Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµĞ¼ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ğ²ÑˆĞ¸ĞµÑÑ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸
    if (finished) return;
    // Ğ¸Ğ»Ğ¸ Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ°ĞµĞ¼ Ğ²Ñ‹Ğ·Ñ‹Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ¼Ğ¸Ñ Ğ¿ĞµÑ€ĞµĞ´Ğ°Ğ²Ğ°Ñ Ñ‚ĞµĞºÑƒÑ‰ÑƒÑ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ.
    value.then((callData) => execute(genData, callData));
  };
}

// Ñ‚ĞµÑÑ‚Ñ‹
const ID = 42;
const delayMS = 1000;

function getId() {
  return new Promise((resolve) => {
    setTimeout(() => {
      resolve(ID);
    }, delayMS);
  });
}

function getDataById(id) {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      id === ID ? resolve('ğŸ') : reject('ğŸ’¥');
    }, delayMS);
  });
}

asyncExecutor(function* () {
  console.time('Time');

  const id = yield getId();
  const data = yield getDataById(id);
  console.log('Data', data);

  console.timeEnd('Time');
});
